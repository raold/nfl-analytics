% TODO.tex — master project TODOs for the NFL PhD + System-of-Systems
% Compile stand-alone or \input{} from main.tex.
\documentclass[11pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[margin=1in]{geometry}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage{todonotes}
\usepackage{marginnote}
\usepackage{hyperref}

% Niceties
\setlist[itemize]{topsep=2pt,itemsep=2pt,parsep=0pt}
\setlist[enumerate]{topsep=2pt,itemsep=2pt,parsep=0pt}

\newcommand{\block}[1]{\par\noindent\textbf{#1}\par\vspace{0.25em}}
\newcommand{\milestone}[1]{\vspace{0.5em}\noindent\textbf{\large #1}\par\vspace{0.25em}\hrule\vspace{0.5em}}
\newcommand{\done}{\textcolor{green!60!black}{\(\checkmark\)}}
\newcommand{\wip}{\textcolor{orange!80!black}{(WIP)}}
\newcommand{\prio}[1]{\textcolor{blue!70!black}{[#1]}}

\begin{document}
\section*{NFL Dissertation + System-of-Systems — Master TODOs}

\subsection*{Global Coordination}
\begin{itemize}
  \item \prio{P0} Freeze \textbf{scope} and \textbf{chapter list} (incl.\ Evaluation \& Calibration; Uncertainty \& Risk; Simulation-Based Strategy Testing; SoS Governance).
  \item \prio{P0} Create \textbf{project calendar} with weekly deliverables (chapters, models, figures, ablations).
  \item \prio{P0} Establish \textbf{reproducibility contract}: seed control, data snapshots, environment pins, CPU/GPU parity notes.
  \item \prio{P0} Baseline \textbf{hardware profiles}: (A) MacBook Air M4 (MPS), (B) dual RTX 5090 workstation (CUDA). Document expected batch sizes / epoch times.
\end{itemize}

\milestone{Data Foundations (1999–2024 core; extend 2025+; selective priors pre-1999)}
\block{Acquisition \& Storage}
\begin{itemize}
  \item \prio{P0} Ingest \textbf{nflfastR/nflverse} play-by-play 1999–2024; extend to 2025 when available.
  \item \prio{P1} Odds history via \textbf{TheOddsAPI} every 10–15 min; persist to \texttt{odds\_history} (book, timestamp, market, price, rule hints).
  \item \prio{P1} Weather joins (Open-Meteo/NOAA), stadium roof/surface map, geocoded stadium coords.
  \item \prio{P1} Schedule context: rest days, travel distance (Haversine), time zones crossed, primetime flags.
  \item \prio{P1} Injury integration: QB-out binary, team AGL index, cumulative starters out; weekly status (out/doubtful/questionable) encoder.
  \item \prio{P2} Referee crew assignments; pace/penalty tendencies.
  \item \prio{P0} DSN normalization across ingestors (R/Python) via \texttt{POSTGRES\_*}. \done
\end{itemize}

\block{Feature Engineering (team-week / game-week grain)}
\begin{itemize}
  \item \prio{P0} EPA/play (team \& splits), Success Rate; opponent-adjusted via ridge; exponential decay (weekly half-life 0.6).
  \item \prio{P0} PROE (pass rate over expected), neutral pace (sec/play), red-zone finishing (regressed).
  \item \prio{P1} Trench proxies: pressure allowed/created, quick-pressure\%, adjusted line yards proxy, stuff rate.
  \item \prio{P1} Role stability: target share, aDOT, YPRR (derive routes if available), WR/TE room deltas on injury.
  \item \prio{P1} Turnover luck: fumble recovery \%, dropped INT proxy; mean-reversion flag.
  \item \prio{P1} Discrete-margin model: fit key-number masses $P(M=n)$; expose as features (3, 6, 7, 10, \dots). \wip\ (moment-preserving reweight implemented)
  \item \prio{P2} Market microstructure features: hold, cross-book CBV, line-move velocity (dLine/dt), implied vs model deltas.
  \item \prio{P0} As-of snapshot builder (team-game rows) enforcing $t\le$ cutoff; weather/odds joins. \done
\end{itemize}

\block{Data Quality \& Testing}
\begin{itemize}
  \item \prio{P0} Schema contracts; NOT NULLs; FK constraints; de-dupe policies for odds.
  \item \prio{P0} Validation suite (basic): row counts per week, join rates, missingness dashboards.
  \item \prio{P0} Analytic marts: auto-create \texttt{mart.team\_epa} and \texttt{mart.game\_summary} (materialized view); include refresh step post-ingest. \done
  \item \prio{P1} Statistical validation (Great-Expectations-style): value ranges, distribution drift monitors (weekly).
  \item \prio{P1} Era handling: weighting schedule, \texttt{era} feature; strike years/OT rule changes guards.
\end{itemize}

\milestone{Baseline Models (Classical)}
\block{Implementations}
\begin{itemize}
  \item \prio{P0} \textbf{GLM}: spread $\to$ win prob (logit), home-field fixed effect; injury/weather interactions.
  \item \prio{P0} \textbf{Stern (1991)} normal mapping sanity checks; calibrate $\sigma$ seasonally.
  \item \prio{P1} \textbf{State-space ratings} (Glickman--Stern): weekly $\theta$ for team strength via Kalman/Stan; posteriors.
  \item \prio{P1} \textbf{Bivariate Poisson / Skellam} (Dixon--Coles; Karlis--Ntzoufras): score distribution, low-score dependence tweak; dynamic intensities (Koopman et al.).
  \item \prio{P1} \textbf{In-play RF} (Lock--Nettleton) scaffolding for live WP (optional, keep modular).
\end{itemize}

\block{Calibration \& Outputs}
\begin{itemize}
  \item \prio{P0} Brier \& LogLoss vs.\ holdout; reliability diagrams; PIT for score distro.
  \item \prio{P0} Vegas comparison: error vs closing spread; ATS/ML hit rates; CLV differentials.
\end{itemize}

\milestone{RL Capstone}
\block{Agent Design}
\begin{itemize}
  \item \prio{P0} DQN baseline: state (priors, features, market), actions (bet/no-bet or discrete stake buckets), reward (PnL; CLV-shaped variant).
  \item \prio{P1} PPO actor-critic for richer actions (alt-lines/teasers/staking); entropy reg; clipping.
  \item \prio{P1} Offline RL dataset (historic games as trajectories); behavior policy notes. \done\ (dataset builder; notes pending)
  \item \prio{P0} OPE gate grid: SNIS/DR grid + ESS; JSON + TeX emitter. \done
\end{itemize}

\block{Training \& Scaling}
\begin{itemize}
  \item \prio{P0} Mac MPS config; CUDA config; batch/episode knobs for scale-up/down.
  \item \prio{P1} Experience replay buffers; target networks (DQN); advantage normalization (PPO).
  \item \prio{P1} Evaluation protocols: fixed-season rolling windows; no leakage; ATS/ROI metrics.
\end{itemize}

\milestone{Ensembles \& Comparative Backtesting}
\begin{itemize}
  \item \prio{P0} Unified backtest harness: run GLM / Poisson / State-space / RL; collect metrics (Brier, LogLoss, ROI, Kelly growth, Sharpe).
  \item \prio{P1} Simple ensembles (avg / logistic stack); Bayesian model averaging (optional).
  \item \prio{P1} Ablations: remove feature families (injury/weather/trenches) to quantify marginal lift.
\end{itemize}

\milestone{Uncertainty \& Risk}
\begin{itemize}
  \item \prio{P0} Posterior distributions (state-space, Poisson); bootstrap ensembles for GLM.
  \item \prio{P0} Fractional Kelly module; bankroll simulator; risk-of-ruin \& max drawdown analytics. \wip\ (CVaR LP implemented; TeX report emitter added)
  \item \prio{P1} Uncertainty-aware policy: downweight bets under wide posterior intervals.
\end{itemize}

\milestone{Simulation-Based Strategy Testing}
\begin{itemize}
  \item \prio{P0} Monte Carlo engine: simulate margins via fitted discrete distro; correlate with totals. \wip
  \item \prio{P0} Price teasers/alt-spreads via integer-crossing sums; EV curves vs book pricing.
  \item \prio{P1} Middle detection thresholds; multi-book arbitrage scan (if legal venue assumed).
  \item \prio{P0} Acceptance checks: JSON report + TeX table for margins/keys/dependence/frictions. \done
\end{itemize}

\milestone{Narrative \& Explainability}
\begin{itemize}
  \item \prio{P1} SHAP for GLM/trees; factor attributions for game-level predictions.
  \item \prio{P1} Rule miner: situational tags (short rest + cross-timezone + TNF).
  \item \prio{P1} Insight generator: plain-language rationales (margin notes / appendix snippets).
\end{itemize}

\milestone{Evaluation \& Calibration (Dissertation Chapter)}
\begin{itemize}
  \item \prio{P0} Define metrics: Brier, LogLoss, AUC, Accuracy, ROI, Kelly growth, Sharpe.
  \item \prio{P0} Reliability diagrams; PIT histograms; CLV sparklines (margin figures). \wip
  \item \prio{P1} Vegas baseline tables; head-to-head model comparisons.
\end{itemize}

\milestone{System-of-Systems Governance}
\begin{itemize}
  \item \prio{P0} Experiment tracking (MLflow or Postgres schema: runs, params, metrics, artifacts).
  \item \prio{P0} Model registry \& promotion policy; semantic versioning; rollback plan.
  \item \prio{P1} Pipeline DAG diagram; data lineage; environment manifests (Docker + native).
\end{itemize}

\milestone{Writing \& Figures}
\begin{itemize}
  \item \prio{P0} Tufte-style layout: decide margin-note density; figure sizing guidelines; sparkline examples.
  \item \prio{P0} “How we chose the timeframe” section with era weighting rationale.
  \item \prio{P0} Literature integration chapter (top-10 models) + benchmark scripts references.
  \item \prio{P1} Appendix: full visual gallery (key-number histos, teaser EV heatmaps, calibration plots).
\end{itemize}

\milestone{Bibliography \& Citations}
\begin{itemize}
  \item \prio{P0} Maintain single \texttt{references.bib}; keep keys stable; add DOIs/URLs where missing.
  \item \prio{P0} Audit all \texttt{\textbackslash cite\{\}} have corresponding entries; compile warnings = 0.
\end{itemize}

\subsection*{Quality Gates (per milestone)}
\begin{itemize}
  \item Repro pass: deterministic runs (seeded), environment pinned, same metrics across machines.
  \item Validity pass: calibration in tolerance; Vegas comparison documented.
  \item Docs pass: figures captioned; equations referenced; todos burned down or deferred.
\end{itemize}

\end{document}
